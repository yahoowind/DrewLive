name: ğŸš€ PPV Scraper & Playlist Update

on:
  schedule:
    - cron: '*/30 * * * *'  # â° Every 30 minutes
  workflow_dispatch:       # ğŸ”¥ Manual trigger

jobs:
  scrape-and-commit:
    runs-on: ubuntu-latest
    env:
      DEBUG: "pw:api"       # ğŸ•µï¸â€â™‚ï¸ Playwright debug logs
    steps:
    - name: ğŸ“¥ Checkout repo
      uses: actions/checkout@v3

    - name: ğŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.11"

    - name: ğŸ“¦ Install Python dependencies
      run: |
        python -m pip install --upgrade pip
        pip install playwright aiohttp

    - name: ğŸ­ Install Playwright browsers & dependencies
      uses: microsoft/playwright-github-action@v1

    - name: ğŸƒ Run PPV scraper script
      run: |
        python ppv.py

    - name: ğŸ§¹ Configure git user for commit
      run: |
        git config user.name "daddybot ğŸ¤–"
        git config user.email "daddybot@example.com"

    - name: ğŸ“ Commit and push changes
      run: |
        git add PPVLand.m3u8
        git commit -m "ğŸ¤– Auto update PPVLand.m3u8 [forced]"
        git push
      continue-on-error: true   # ğŸš¨ Prevent fail if nothing to commit or push issues
